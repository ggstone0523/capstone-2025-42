<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>로그인</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
  <div class="bg-white p-8 rounded shadow-md w-96">
    <h2 class="text-2xl font-bold mb-4">로그인</h2>

    <div id="message" class="mb-4 text-sm text-red-500"></div>

    <input type="text" id="username" placeholder="아이디"
      class="border w-full px-3 py-2 rounded mb-2" />
    <input type="password" id="password" placeholder="비밀번호"
      class="border w-full px-3 py-2 rounded mb-4" />

    <div class="flex gap-2">
      <button onclick="login()" class="bg-blue-500 text-white px-4 py-2 rounded">로그인</button>
      <button onclick="register()" class="bg-gray-500 text-white px-4 py-2 rounded">회원가입</button>
    </div>
  </div>

  <script>
    function showMessage(msg, isError = true) {
      const el = document.getElementById('message');
      el.textContent = msg;
      el.className = isError ? 'text-red-500 text-sm mb-4' : 'text-green-500 text-sm mb-4';
    }

    async function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;

      const res = await fetch(`/api/login`, {
        method: 'POST',
	credentials: "include",
        headers: { 
		'Content-Type': 'application/json',
	},
        body: JSON.stringify({ username, password })
      });

      const data = await res.json();
      if (res.ok) {
        showMessage('로그인 성공! 메인 페이지로 이동합니다.', false);
        setTimeout(() => window.location.reload(), 1000);
      } else {
        showMessage(data.message || '로그인 실패');
      }
    }

    async function register() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;

      const res = await fetch(`/api/register`, {
        method: 'POST',
	credentials: "include",
        headers: { 
		'Content-Type': 'application/json', 
	},
        body: JSON.stringify({ username, password })
      });

      const data = await res.json();
      if (res.ok) {
        showMessage('회원가입 성공! 이제 로그인해 주세요.', false);
      } else {
        showMessage(data.message || '회원가입 실패');
      }
    }
  </script>
</body>
</html>

